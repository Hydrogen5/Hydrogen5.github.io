---
title: 数据库系统概念阅读记录
date: 2020-03-16 13:19:58
tags:
hide: true
---
说是阅读记录，其实只是练习题的做题记录吧。  
所有数据库均来源于[官方网站](https://www.db-book.com/db6/lab-dir/sample_tables-dir/)

## Chapter III
##### 3.1  
###### a  
```sql
select title from course where dept_name = 'Comp. Sci.' and credits = 3;
```

###### b

```sql
select s_ID from instructor,advisor where instructor.ID = advisor.i_ID and name = 'Einstein';
```

###### c

```sql
select max(salary) from instructor;
```

###### d

```sql
select * from instructor where salary = (select max(salary) from instructor);
```

###### e

```sql
select count(id) as cnt,course_id from takes where year=2009 and semester='Fall' group by course_id;
```

###### f

```sql
select max(T.cnt) from (select count(id) as cnt,course_id from takes where year=2009 and semester='Fall' group by course_id) as T;
```

###### g

```sql
select * from (select count(id) as cnt,course_id from takes where year=2009 and semester='Fall' group by course_id) as T(cnt,id) order by cnt desc limit 1;
```

似乎不太对

##### 3.2

###### a

```sql
select sum(points*credits) from (select course_id, grade as g from takes where ID=12345) as T(id,grade), course, grade_points where T.id=course.course_id and grade_e=grade;
```

###### b

```sql
select sum(points*credits)/sum(credits) from (select course_id, grade as g from takes where ID=12345) as T(id,grade), course, grade_points where T.id=course.course_id and grade_e=grade;
```

###### c

```sql
select sum(points*credits) from (select id course_id, grade as g from takes where ID=12345) as T(id,cid,grade), course, grade_points group by id where T.cid=course.course_id and grade_e=grade;
```

##### 3.3

###### a

```sql
update instructor set salary=salary*1.1;
```

##### b

```sql
delete from course where course_id not in (select course_id from section);
```

###### c

```sql
insert into instructor select ID,name,dept_name,10000 from student where tot_cred>100;
```

##### 3.4

###### a

```sql
select count(distinct driver_id) from accident natural join participated where date between '2009-1-1' and '2009-12-31';
```

###### b

```sql
insert into accident values(114514,'1926-8-7','tokyo');
```

###### c

```sql
delete from car where model = 'Mazda' and license in (select lisense from person natural join owns where name = 'John Smith');
```

##### 3.5

###### a

```sql
Select ID, case
           when score<40 then ‘F’
           when score<60 then ‘C’
           when score<80 then ‘B’
           else ‘A’
           end
from marks;
```

###### b

```sql
select grade, count(*) from (Select ID, case
           when score<40 then ‘F’
           when score<60 then ‘C’
           when score<80 then ‘B’
           else ‘A’
           end as grade
from marks) group by grade;
```

##### 3.6

```sql
where lower(emp) like 'sci';
```

##### 3.7

r1，r2有一者为空？

